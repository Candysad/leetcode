# 数学



### 费马平方和定理

完全平方数模 4 只可能为 0 或 1，因此不存在两个完全平方数之和模 4 为 3



### 四平方和定理

每个正整数均可由（最多） 4 个正整数的平方加和得到

即有
$$
n,a, b, c, d \in N^+\\\\
n = a^2 + b^2 + c^2 + d^2
$$
并可推出 $n = 4^k \times (8m + 7)$ 时，$n$ 只能最少被 4 个整数的平方加和表达

反之，$n = 4^k \times (8m + 7)$ 时，$n$ 最多可被 3 个正数的平方加和表达

即判断一个数最少由几个正整数的平方表达

- 判断本身是否是平方数 $\rightarrow$ 1 
- 判断除去所有 4 后对 8 取余是否得 7
  - 是  $\rightarrow$ 4
  - 否
    - 遍历 $[1, n]$ 的所有平方数 $i$ 看 $j=n-i$ 是否是平方数
      - 是  $\rightarrow$ 2
      - 否  $\rightarrow$ 3





### 卡塔兰-明安图数

- 每个数符合其前面情况的乘法组合

- 即对于第 $n$ 个数有
  $$
  G(n) = \sum_{i=1}^n G(i-1)G(n-1)
  $$

- 其通项公式为

  
  $$
  C_0 = 1\\\\
  
  C_{n+1} = \frac{2(2n+1)}{n+2}C_n
  $$



### 贝祖定理 / 裴蜀定理

- 对于整数 $a,b$ 和 任意整数 $x,y$，$ax + by = z$ 有解当且仅当 $z$ 是 $x,y$ 最大公约数的倍数
- 特别地，若 $a,b$ 互质，则 $\gcd(a,b) = 1$，$z = 1$ 



#### 水壶问题

- 给两个容量分别为 $x$ 和 $y$ 的水壶

- 单次可以
  - 灌满一个水壶
  - 清空一个水壶
  - 将一个水壶中的水倒入另一个水壶，若有水壶在过程中清空或被装满则停止

- 问能否恰好得到 $z$ 容量的水

- 设某一时刻水壶中装水 $x_c, y_c$

- 即
  - 水壶中的水量是否恰好可有 $x_c = z \ ||\  y_c = z\  ||\  x_c + y_c = z$
  - 进而有是否存在整数  $a,b$ 使得 $ax+by = z$

- 分析
  - 首先肯定有 $z <= x+y$ ，不然再多也装不了
  - 这样看 $a$ 和 $b$ 最多就 $1$
  - 但是可以有负数（设 $x$ 小 $y$ 大）
    - 因为可以将一个壶倒入另一个壶得到 $(y-x) + x$
    - 然后将 $x$ 再完全倒掉，就得到纯粹的 $y-x$​
    - 相当于 $a$ 是负数，进而可以再次对 $y$ 壶加水，使 $b$ 变大
  - 即求 $ax + by = z$ 是否有解

- 根据贝祖定理，$z$ 是 $x,y$ 最大公约数的倍数时问题有解

  ```python
  def measureWater(x:int, y:int, target:int):
      '''
      贝祖定理
      '''
      if z > x + y: return False
      if x == 0 or y == 0:
          return z == 0 or x+y == z
      return z % gcd(x, y) == 0
  ```

**如果要求最少倒水次数**

- 先确定能够得到解
- 用深度优先
  - 配合 vis 记录所有出现的情况
  - 在得到可行解的时候记录倒水次数

- 广度优先
  - 第一次找到可行解的倒水次数就是最少



### 空瓶换水

- 一开始手里有 $a$ 瓶水
- 每 $b$ 个空瓶可以换 $c$ 瓶新的水（$c < b$）
- 最多能喝水 $x$ 瓶，求 $x$

- $a\ge b$ 时，先把手里的水都喝完

- 每次换水，相当于剩余瓶子数 $>b$  时，总体还可以减少 $b-c$ 个瓶子，而换来 $c$ 瓶新水

- 设第 $n$ 次换水后剩余瓶子不够 $b$ 个

  得
  $$
  a - n(b-c) < b\\\\
  n > \frac{a-b}{b-c}\\\\
  a \ge b , n\text{至少比0大,}\\\\
  n \in N, n = \lfloor \frac{a-b}{b-c}+1 \rfloor
  $$



