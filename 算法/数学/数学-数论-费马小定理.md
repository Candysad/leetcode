### 费马小定理

对于素数 $p$ , 若整数 $a$ 满足 $\gcd(a, p) = 1$，则有
$$
\begin{align}
a^{p-1} &\equiv 1 &(\text{mod} \ p)\\
a^p     &\equiv a &(\text{mod} \ p)
\end{align}
$$


 

#### 证明

- 对于所有小于 $p$ 的整数 $b_i \in\{1,2,\cdots, p - 1\}$ ，都有 $\gcd(b_i, p) = 1$
- 对于不是 $p$ 的倍数的整数 $a$，有 $\gcd(a \cdot b_i, p) = 1$
- 则 $a^{p-1}(p-1)! \equiv a \cdot 1 \cdot a \cdot 2 \cdots a \cdot (p-1) \equiv (p-1)! (\text{mod} \ p)$
- 即证 $a^{p-1} \equiv 1 (\text{mod}\ p)$



#### 引理

对于素数 $p$ 和满足 $\gcd(p, a) = 1$ 的整数 $a$
$$
\begin{align}
a^{p-1} &\equiv 1 &(\text{mod} \ p)\\
\Rightarrow a^{p-2} &\equiv a^{-1} &(\text{mod} \ p)
\end{align}
$$
即在对 $p$ 取模的运算中整数 $a$ 的模逆元为 $a^{p-2}\ (\text{mod} \ p)$

